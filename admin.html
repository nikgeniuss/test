<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å FLEX GitHub API</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.1);
            padding: 40px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 800px;
            width: 100%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #FFD700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
        }
        
        .login-section {
            display: block;
        }
        
        .admin-section {
            display: none;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #FFEC8B;
            font-size: 1.1rem;
        }
        
        input[type="text"],
        input[type="password"] {
            width: 100%;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(0, 0, 0, 0.3);
            color: white;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        input[type="text"]:focus,
        input[type="password"]:focus {
            outline: none;
            border-color: #6a11cb;
            box-shadow: 0 0 15px rgba(106, 17, 203, 0.5);
            background: rgba(0, 0, 0, 0.4);
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        button {
            flex: 1;
            padding: 18px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            min-height: 56px;
        }
        
        .login-btn {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            width: 100%;
        }
        
        .login-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(37, 117, 252, 0.3);
        }
        
        .save-btn {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }
        
        .save-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(56, 239, 125, 0.3);
        }
        
        .load-btn {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
        }
        
        .load-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(106, 17, 203, 0.3);
        }
        
        .logout-btn {
            background: linear-gradient(135deg, #f46b45 0%, #eea849 100%);
            color: white;
            margin-top: 20px;
            width: 100%;
        }
        
        .logout-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(244, 107, 69, 0.3);
        }
        
        .message {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            display: none;
        }
        
        .success {
            background: rgba(46, 204, 113, 0.2);
            border: 1px solid #2ecc71;
            color: #2ecc71;
            display: block;
        }
        
        .error {
            background: rgba(231, 76, 60, 0.2);
            border: 1px solid #e74c3c;
            color: #e74c3c;
            display: block;
        }
        
        .info {
            background: rgba(52, 152, 219, 0.2);
            border: 1px solid #3498db;
            color: #3498db;
            display: block;
        }
        
        .password-note {
            text-align: center;
            margin-top: 20px;
            color: #aaa;
            font-size: 14px;
            font-style: italic;
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .instructions h3 {
            color: #FFD700;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .instructions ul {
            margin-left: 20px;
            margin-bottom: 10px;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        code {
            background: rgba(0, 0, 0, 0.3);
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }
        
        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ */
        .loader {
            display: none;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin: 0 auto;
        }
        
        .loading .loader {
            display: block;
        }
        
        .loading .btn-text {
            opacity: 0;
        }
        
        .button-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ */
        .valid {
            border-color: #2ecc71 !important;
            box-shadow: 0 0 10px rgba(46, 204, 113, 0.3) !important;
        }
        
        .invalid {
            border-color: #e74c3c !important;
            box-shadow: 0 0 10px rgba(231, 76, 60, 0.3) !important;
        }
        
        .validation-hint {
            margin-top: 5px;
            font-size: 12px;
            display: none;
        }
        
        .validation-hint.valid {
            color: #2ecc71;
            display: block;
        }
        
        .validation-hint.invalid {
            color: #e74c3c;
            display: block;
        }
        
        .github-info {
            background: rgba(36, 41, 46, 0.5);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #6e40c9;
        }
        
        .github-info h3 {
            color: #6e40c9;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 25px;
            }
            
            .buttons {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            label {
                font-size: 1rem;
            }
            
            input[type="text"],
            input[type="password"] {
                padding: 12px;
                font-size: 15px;
            }
            
            button {
                min-height: 50px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –°–µ–∫—Ü–∏—è –≤—Ö–æ–¥–∞ -->
        <div class="login-section" id="loginSection">
            <h1>üîê –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å FLEX GitHub API</h1>
            
            <div class="github-info">
                <h3>üêô –ù–∞—Å—Ç—Ä–æ–π–∫–∏ GitHub</h3>
                <div class="form-group">
                    <label for="githubToken">GitHub Personal Access Token:</label>
                    <input type="password" id="githubToken" 
                           placeholder="ghp_xxxxxxxxxxxxxxxxxxxx"
                           autocomplete="off">
                </div>
                <div class="form-group">
                    <label for="githubRepo">–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (username/repo):</label>
                    <input type="text" id="githubRepo" 
                           placeholder="yourusername/your-repo"
                           value="Ex-Flex/flex">
                </div>
                <div class="form-group">
                    <label for="githubBranch">–í–µ—Ç–∫–∞:</label>
                    <input type="text" id="githubBranch" 
                           placeholder="main"
                           value="main">
                </div>
            </div>
            
            <div class="form-group">
                <label for="password">üîë –ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏:</label>
                <input type="password" id="password" 
                       placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏"
                       autocomplete="off">
            </div>
            
            <button class="login-btn" onclick="checkAndLogin()" id="loginButton">
                <div class="button-content">
                    <div class="loader" id="loginLoader"></div>
                    <span class="btn-text">üîó –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ GitHub –∏ –≤–æ–π—Ç–∏</span>
                </div>
            </button>
            
            <div class="password-note">
                <p><strong>GitHub Token:</strong> —Å–æ–∑–¥–∞–π—Ç–µ –≤ GitHub Settings ‚Üí Developer settings</p>
                <p><a href="./" style="color: #3498db; text-decoration: none;">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É</a></p>
            </div>
        </div>
        
        <!-- –°–µ–∫—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
        <div class="admin-section" id="adminSection">
            <div class="github-info">
                <h3>‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ GitHub</h3>
                <p id="repoInfo">–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: <span id="currentRepo"></span></p>
                <p id="branchInfo">–í–µ—Ç–∫–∞: <span id="currentBranch"></span></p>
            </div>
            
            <h1>‚öôÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Telegram —Å—Å—ã–ª–æ–∫ —á–µ—Ä–µ–∑ GitHub API</h1>
            
            <div class="form-group">
                <label for="link1">üì± –°—Å—ã–ª–∫–∞ –¥–ª—è –ø–µ—Ä–≤–æ–π –∫–Ω–æ–ø–∫–∏ (Telegram 1):</label>
                <input type="text" id="link1" placeholder="tg://resolve?domain=Ex_Flex" 
                       oninput="validateTelegramLink(this)">
                <div class="validation-hint" id="hint1"></div>
            </div>
            
            <div class="form-group">
                <label for="link2">üì± –°—Å—ã–ª–∫–∞ –¥–ª—è –≤—Ç–æ—Ä–æ–π –∫–Ω–æ–ø–∫–∏ (Telegram 2):</label>
                <input type="text" id="link2" placeholder="https://t.me/+ef-zedL8qyhkNWYy"
                       oninput="validateTelegramLink(this)">
                <div class="validation-hint" id="hint2"></div>
            </div>
            
            <div class="form-group">
                <label for="link3">üì± –°—Å—ã–ª–∫–∞ –¥–ª—è —Ç—Ä–µ—Ç—å–µ–π –∫–Ω–æ–ø–∫–∏ (Telegram 3):</label>
                <input type="text" id="link3" placeholder="https://t.me/your_group_3"
                       oninput="validateTelegramLink(this)">
                <div class="validation-hint" id="hint3"></div>
            </div>
            
            <div class="message" id="message"></div>
            
            <div class="buttons">
                <button class="load-btn" onclick="loadConfigFromGitHub()" id="loadButton">
                    <div class="button-content">
                        <div class="loader" id="loadLoader"></div>
                        <span class="btn-text">üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ GitHub</span>
                    </div>
                </button>
                <button class="save-btn" onclick="saveConfigToGitHub()" id="saveButton">
                    <div class="button-content">
                        <div class="loader" id="saveLoader"></div>
                        <span class="btn-text">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ GitHub</span>
                    </div>
                </button>
            </div>
            
            <button class="logout-btn" onclick="logout()">
                üö™ –í—ã–π—Ç–∏ –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
            </button>
            
            <div class="instructions">
                <h3>üìã –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç GitHub API:</h3>
                <ul>
                    <li>–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ <code>config.json</code> –≤ –≤–∞—à–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏</li>
                    <li>–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ - —á–∏—Ç–∞–µ–º —Ñ–∞–π–ª —á–µ—Ä–µ–∑ GitHub API</li>
                    <li>–ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ - –æ–±–Ω–æ–≤–ª—è–µ–º —Ñ–∞–π–ª —á–µ—Ä–µ–∑ GitHub API</li>
                    <li>–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ä–∞–∑—É –ø–æ—è–≤–ª—è—é—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ —á–µ—Ä–µ–∑ GitHub Pages</li>
                </ul>
                <p><strong>GitHub API Endpoints:</strong></p>
                <ul>
                    <li><code>GET /repos/{owner}/{repo}/contents/{path}</code> - –ø–æ–ª—É—á–∏—Ç—å —Ñ–∞–π–ª</li>
                    <li><code>PUT /repos/{owner}/{repo}/contents/{path}</code> - –æ–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª</li>
                </ul>
                <p><strong>–í–∞–∂–Ω–æ:</strong> –¢–æ–∫–µ–Ω –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.</p>
            </div>
        </div>
    </div>

    <script>
        // === –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ===
        const ADMIN_PASSWORD = "flex2024";
        const CONFIG_FILE = "config.json";
        
        let githubToken = null;
        let githubRepo = null;
        let githubOwner = null;
        let githubRepoName = null;
        let githubBranch = "main";
        let currentSha = null; // SHA —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

        // === –£–¢–ò–õ–ò–¢–´ ===
        function showLoader(buttonId, loaderId, show = true) {
            const button = document.getElementById(buttonId);
            const loader = document.getElementById(loaderId);
            
            if (show) {
                button.classList.add('loading');
                button.disabled = true;
            } else {
                button.classList.remove('loading');
                button.disabled = false;
            }
        }

        function showMessage(text, type = 'info') {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = text;
            messageDiv.className = `message ${type}`;
            messageDiv.style.display = 'block';
            
            if (type !== 'info') {
                setTimeout(() => {
                    messageDiv.style.display = 'none';
                }, 5000);
            }
        }

        function showAdminPanel() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('adminSection').style.display = 'block';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
            document.getElementById('currentRepo').textContent = githubRepo;
            document.getElementById('currentBranch').textContent = githubBranch;
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—É—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
            loadConfigFromGitHub();
        }

        // === –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï –í–´–•–û–î–ê ===
        function logout() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏ –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏?\n–¢–æ–∫–µ–Ω GitHub –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω –∏–∑ –ø–∞–º—è—Ç–∏.')) {
                githubToken = null;
                githubRepo = null;
                currentSha = null;
                
                localStorage.removeItem('flex_github_token');
                localStorage.removeItem('flex_github_repo');
                localStorage.removeItem('flex_github_branch');
                
                location.reload();
            }
        }

        // === –í–ê–õ–ò–î–ê–¶–ò–Ø –°–°–´–õ–û–ö ===
        function isValidTelegramLink(link) {
            if (!link.trim()) return false;
            
            const telegramPatterns = [
                /^tg:\/\/resolve\?domain=[a-zA-Z0-9_]{5,32}$/,
                /^tg:\/\/resolve\?domain=[a-zA-Z0-9_]{5,32}&[a-zA-Z0-9_=&-]+$/,
                /^https?:\/\/(t\.me|telegram\.me)\/[a-zA-Z0-9_]{5,32}$/,
                /^https?:\/\/(t\.me|telegram\.me)\/joinchat\/[a-zA-Z0-9_-]{22}$/,
                /^https?:\/\/(t\.me|telegram\.me)\/\+[a-zA-Z0-9_-]{12,}$/,
                /^https?:\/\/(t\.me|telegram\.me)\/c\/\d+$/,
            ];
            
            return telegramPatterns.some(pattern => pattern.test(link.trim()));
        }

        function validateTelegramLink(input) {
            const value = input.value.trim();
            const hintId = input.id.replace('link', 'hint');
            const hint = document.getElementById(hintId);
            
            if (!value) {
                input.classList.remove('valid', 'invalid');
                hint.className = 'validation-hint';
                hint.textContent = '';
                return false;
            }
            
            if (isValidTelegramLink(value)) {
                input.classList.remove('invalid');
                input.classList.add('valid');
                hint.className = 'validation-hint valid';
                hint.textContent = '‚úì –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è Telegram —Å—Å—ã–ª–∫–∞';
                return true;
            } else {
                input.classList.remove('valid');
                input.classList.add('invalid');
                hint.className = 'validation-hint invalid';
                hint.textContent = '‚úó –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: tg://resolve?domain=username –∏–ª–∏ https://t.me/username';
                return false;
            }
        }

        function validateAllLinks() {
            const link1 = document.getElementById('link1');
            const link2 = document.getElementById('link2');
            const link3 = document.getElementById('link3');
            
            return validateTelegramLink(link1) && 
                   validateTelegramLink(link2) && 
                   validateTelegramLink(link3);
        }

        // === GITHUB API –§–£–ù–ö–¶–ò–ò ===
        async function testGitHubConnection() {
            try {
                const response = await fetch(`https://api.github.com/repos/${githubRepo}`, {
                    headers: {
                        'Authorization': `token ${githubToken}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.status === 401) {
                    throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π GitHub —Ç–æ–∫–µ–Ω');
                }
                if (response.status === 404) {
                    throw new Error('–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }
                if (!response.ok) {
                    throw new Error(`GitHub API –æ—à–∏–±–∫–∞: ${response.status}`);
                }
                
                const repoData = await response.json();
                return {
                    success: true,
                    repo: repoData
                };
            } catch (error) {
                return {
                    success: false,
                    error: error.message
                };
            }
        }

        async function checkAndLogin() {
            const token = document.getElementById('githubToken').value.trim();
            const repo = document.getElementById('githubRepo').value.trim();
            const branch = document.getElementById('githubBranch').value.trim() || 'main';
            const password = document.getElementById('password').value;
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞
            if (!token) {
                showMessage('–í–≤–µ–¥–∏—Ç–µ GitHub Personal Access Token', 'error');
                return;
            }
            
            if (!repo || !repo.includes('/')) {
                showMessage('–í–≤–µ–¥–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ: username/repo', 'error');
                return;
            }
            
            if (!password) {
                showMessage('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏', 'error');
                return;
            }
            
            if (password !== ADMIN_PASSWORD) {
                showMessage('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏', 'error');
                return;
            }
            
            showLoader('loginButton', 'loginLoader', true);
            
            try {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
                githubToken = token;
                githubRepo = repo;
                githubBranch = branch;
                
                // –ü–∞—Ä—Å–∏–º username –∏ repo name
                const [owner, repoName] = repo.split('/');
                githubOwner = owner;
                githubRepoName = repoName;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ GitHub
                showMessage('–ü—Ä–æ–≤–µ—Ä—è—é –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ GitHub...', 'info');
                
                const connectionTest = await testGitHubConnection();
                
                if (!connectionTest.success) {
                    showMessage(`–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ GitHub: ${connectionTest.error}`, 'error');
                    showLoader('loginButton', 'loginLoader', false);
                    return;
                }
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                localStorage.setItem('flex_github_token', token);
                localStorage.setItem('flex_github_repo', repo);
                localStorage.setItem('flex_github_branch', branch);
                
                showAdminPanel();
                showMessage('‚úÖ –£—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ GitHub!', 'success');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
                showMessage(`–û—à–∏–±–∫–∞: ${error.message}`, 'error');
            } finally {
                showLoader('loginButton', 'loginLoader', false);
            }
        }

        async function loadConfigFromGitHub() {
            if (!githubToken || !githubRepo) {
                showMessage('–°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ GitHub', 'error');
                return;
            }
            
            showLoader('loadButton', 'loadLoader', true);
            
            try {
                const url = `https://api.github.com/repos/${githubRepo}/contents/${CONFIG_FILE}?ref=${githubBranch}`;
                
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `token ${githubToken}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.status === 404) {
                    // –§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    document.getElementById('link1').value = 'tg://resolve?domain=Ex_Flex';
                    document.getElementById('link2').value = 'https://t.me/+ef-zedL8qyhkNWYy';
                    document.getElementById('link3').value = 'https://t.me/–≤–∞—à–∞_–≥—Ä—É–ø–ø–∞_3';
                    
                    // –í–∞–ª–∏–¥–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    validateTelegramLink(document.getElementById('link1'));
                    validateTelegramLink(document.getElementById('link2'));
                    validateTelegramLink(document.getElementById('link3'));
                    
                    showMessage('–§–∞–π–ª config.json –Ω–µ –Ω–∞–π–¥–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.', 'info');
                    showLoader('loadButton', 'loadLoader', false);
                    return;
                }
                
                if (!response.ok) {
                    throw new Error(`GitHub API –æ—à–∏–±–∫–∞: ${response.status}`);
                }
                
                const fileData = await response.json();
                
                // –î–µ–∫–æ–¥–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ (base64)
                const content = atob(fileData.content);
                const config = JSON.parse(content);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º SHA –¥–ª—è –±—É–¥—É—â–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
                currentSha = fileData.sha;
                
                // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª—è
                if (config.telegramLinks && config.telegramLinks.length >= 3) {
                    document.getElementById('link1').value = config.telegramLinks[0] || '';
                    document.getElementById('link2').value = config.telegramLinks[1] || '';
                    document.getElementById('link3').value = config.telegramLinks[2] || '';
                    
                    // –í–∞–ª–∏–¥–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
                    validateTelegramLink(document.getElementById('link1'));
                    validateTelegramLink(document.getElementById('link2'));
                    validateTelegramLink(document.getElementById('link3'));
                    
                    showMessage('–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ GitHub!', 'success');
                } else {
                    throw new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç config.json');
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                showMessage(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}`, 'error');
            } finally {
                showLoader('loadButton', 'loadLoader', false);
            }
        }

        async function saveConfigToGitHub() {
            if (!githubToken || !githubRepo) {
                showMessage('–°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ GitHub', 'error');
                return;
            }
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Å—ã–ª–æ–∫
            if (!validateAllLinks()) {
                showMessage('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏ –≤ –ø–æ–ª—è—Ö –≤–≤–æ–¥–∞!', 'error');
                return;
            }
            
            const link1 = document.getElementById('link1').value.trim();
            const link2 = document.getElementById('link2').value.trim();
            const link3 = document.getElementById('link3').value.trim();
            
            if (!link1 || !link2 || !link3) {
                showMessage('–í—Å–µ —Ç—Ä–∏ –ø–æ–ª—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω—ã!', 'error');
                return;
            }
            
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –Ω–∞ GitHub?\n–≠—Ç–æ –∏–∑–º–µ–Ω–∏—Ç —Ñ–∞–π–ª config.json –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.')) {
                return;
            }
            
            showLoader('saveButton', 'saveLoader', true);
            
            try {
                // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
                const config = {
                    telegramLinks: [link1, link2, link3],
                    version: '1.0',
                    lastModified: new Date().toISOString(),
                    modifiedBy: 'admin-panel'
                };
                
                const content = JSON.stringify(config, null, 2);
                const contentBase64 = btoa(unescape(encodeURIComponent(content)));
                
                const url = `https://api.github.com/repos/${githubRepo}/contents/${CONFIG_FILE}`;
                
                const body = {
                    message: `Update ${CONFIG_FILE} via admin panel`,
                    content: contentBase64,
                    branch: githubBranch,
                    ...(currentSha ? { sha: currentSha } : {})
                };
                
                const response = await fetch(url, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${githubToken}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(body)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    // –û–±–Ω–æ–≤–ª—è–µ–º SHA –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
                    currentSha = result.content.sha;
                    
                    showMessage('‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ GitHub!', 'success');
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∫–æ–º–º–∏—Ç
                    if (result.commit && result.commit.html_url) {
                        setTimeout(() => {
                            showMessage(`–ö–æ–º–º–∏—Ç —Å–æ–∑–¥–∞–Ω: ${result.commit.html_url}`, 'info');
                        }, 2000);
                    }
                } else {
                    let errorMsg = '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è';
                    if (result.message) {
                        errorMsg += `: ${result.message}`;
                    }
                    throw new Error(errorMsg);
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
                showMessage(`–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ${error.message}`, 'error');
            } finally {
                setTimeout(() => {
                    showLoader('saveButton', 'saveLoader', false);
                }, 1000);
            }
        }

        // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ===
        document.addEventListener('DOMContentLoaded', () => {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ GitHub
            const savedToken = localStorage.getItem('flex_github_token');
            const savedRepo = localStorage.getItem('flex_github_repo');
            const savedBranch = localStorage.getItem('flex_github_branch');
            
            if (savedToken && savedRepo) {
                // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª—è
                document.getElementById('githubToken').value = savedToken;
                document.getElementById('githubRepo').value = savedRepo;
                if (savedBranch) {
                    document.getElementById('githubBranch').value = savedBranch;
                }
                
                // –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –≤–æ–π—Ç–∏
                showMessage('–ù–∞–π–¥–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ GitHub. –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∏ –Ω–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏"', 'info');
            }
            
            // –ê–≤—Ç–æ–≤—Ö–æ–¥ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Enter
            document.getElementById('password').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    checkAndLogin();
                }
            });
        });

        console.log('–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å FLEX GitHub API –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
    </script>
</body>
</html>
